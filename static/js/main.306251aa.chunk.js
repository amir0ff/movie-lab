(this["webpackJsonpmovie-lab"]=this["webpackJsonpmovie-lab"]||[]).push([[0],{102:function(e,t,a){},103:function(e,t,a){},104:function(e,t,a){},106:function(e,t,a){},107:function(e,t,a){},114:function(e,t,a){"use strict";a.r(t);var c=a(0),n=a.n(c),s=a(22),r=a.n(s),i=a(20),o=(a(78),a(15)),l=a(12),j=function(e,t){switch(t.type){case"SET_USER":return Object(l.a)(Object(l.a)({},e),{},{loggedUser:t.payload});case"AUTHENTICATE_USER":return Object(l.a)(Object(l.a)({},e),{},{isUserAuthenticated:t.payload});case"SET_PERSISTENCE":return Object(l.a)(Object(l.a)({},e),{},{persistenceType:t.payload});case"LIKE_MOVIE":return Object(l.a)(Object(l.a)({},e),{},{favoriteMovies:e.favoriteMovies.concat(t.payload)});case"UNLIKE_MOVIE":return Object(l.a)(Object(l.a)({},e),{},{favoriteMovies:e.favoriteMovies.filter((function(e){return e.imdbID!==t.payload}))});case"PURGE_STATE":return O;default:return e}},b=a(2);function u(e){var t=e.children,a=Object(c.useReducer)(j,function(){if("undefined"===typeof Storage)throw new Error("You need to enable Storage to run this app.");var e=JSON.parse(localStorage.getItem("globalState"));return JSON.parse(sessionStorage.getItem("globalState"))||e||O}()),n=Object(o.a)(a,2),s=n[0],r=n[1],i=Object(c.useRef)(!0),l=Object(c.useRef)(!0);return Object(c.useEffect)((function(){if(i.current)i.current=!1;else{var e=s.persistenceType;"sessionStorage"===e?sessionStorage.setItem("globalState",JSON.stringify(s)):"localStorage"===e&&localStorage.setItem("globalState",JSON.stringify(s))}}),[s]),Object(c.useEffect)((function(){if(l.current)l.current=!1;else{var e=s.persistenceType;"sessionStorage"===e?localStorage.removeItem("globalState"):"localStorage"===e&&sessionStorage.removeItem("globalState")}}),[s.persistenceType]),Object(b.jsx)(d.Provider,{value:{globalState:s,dispatch:r},children:t})}var d=Object(c.createContext)({}),O={favoriteMovies:[],isUserAuthenticated:!1,loggedUser:"",persistenceType:"sessionStorage"};var m=a(7),f=a(119),h=a(32),x=a.n(h),p=a(40),v=a(120),g=a(67),S=a(121),y=a(69),N=a(122),E=a(64),T=a.n(E),I="&apikey="+a(65).a.API_KEY;function C(e){return T.a.get("".concat("https://www.omdbapi.com/?s=").concat(e).concat(I))}var U=a(128),w=a(25),M=a(68),R=a(33),k=a(66);a(102);function L(e){var t=e.movie,a=Object(c.useContext)(d),n=a.globalState,s=a.dispatch,r=Object(c.useState)(n.favoriteMovies.some((function(e){return e.imdbID===t.imdbID}))),i=Object(o.a)(r,2),j=i[0],u=i[1],O=Object(k.useDoubleTap)((function(){j?f():m()}));function m(){j||(u(!0),s({type:"LIKE_MOVIE",payload:t}))}function f(){u(!1),s({type:"UNLIKE_MOVIE",payload:t.imdbID})}return Object(b.jsx)(g.a,{className:"mb-4 movie-container",children:Object(b.jsxs)(U.a,{className:"",children:[Object(b.jsx)("img",Object(l.a)({src:t.Poster,alt:t.Title},O)),Object(b.jsxs)(U.a.Body,{children:[Object(b.jsx)("h5",{className:"card-title",children:t.Title}),Object(b.jsx)("p",{className:"card-text",children:t.Year}),Object(b.jsxs)("p",{className:"card-text",children:[Object(b.jsx)("a",{href:"https://www.imdb.com/title/".concat(t.imdbID,"/"),target:"_blank",rel:"noreferrer",children:Object(b.jsx)(w.a,{icon:M.a,size:"4x"})}),Object(b.jsx)("span",{className:"font-weight-bold",children:"IMDb: "}),t.imdbID.toUpperCase()]})]}),j?Object(b.jsx)("button",{type:"button",className:"btn btn-secondary fav-btn",title:"Unlike",onClick:f,children:Object(b.jsx)(w.a,{icon:R.c})}):Object(b.jsx)("button",{type:"button",className:"btn btn-danger remove-btn",title:"Like",onClick:m,children:Object(b.jsx)(w.a,{icon:R.b})})]})})}a(103);function _(e){var t=e.movies;return Object(b.jsx)(f.a,{className:"main-movies-container",children:Object(b.jsx)(v.a,{className:"d-flex mt-4 flex-wrap justify-content-start align-items-start",children:t.map((function(e,t){return Object(b.jsx)(L,{movie:e},e.imdbID+t)}))})})}a(104);function A(){var e=Object(c.useState)([]),t=Object(o.a)(e,2),a=t[0],n=t[1],s=Object(c.useState)(""),r=Object(o.a)(s,2),i=r[0],l=r[1],j=Object(c.useState)(""),u=Object(o.a)(j,2),d=u[0],O=u[1],m=Object(c.useState)(""),h=Object(o.a)(m,2),E=h[0],T=h[1],I=Object(c.useState)(!1),U=Object(o.a)(I,2),w=U[0],M=U[1];function R(){return(R=Object(p.a)(x.a.mark((function e(t){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return M(!0),T(t),e.next=4,C(t).then((function(e){var t=e.data;"True"===t.Response?(n(t.Search),l(""),M(!1)):"False"===t.Response&&(l(t.Error),M(!1))})).catch((function(e){console.error(e),l(e.message),M(!1)}));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(c.useEffect)((function(){var e=setTimeout((function(){if(d!==E)return function(e){return R.apply(this,arguments)}(d)}),600);return function(){return clearTimeout(e)}}),[d]),Object(b.jsxs)(f.a,{fluid:"xl",className:"mt-4 search-container",children:[Object(b.jsxs)(v.a,{children:[Object(b.jsx)(g.a,{md:{span:6,offset:3},className:"d-flex justify-content-center mt-3",children:Object(b.jsxs)(S.a,{children:[Object(b.jsx)(y.a,{placeholder:"Search by title",className:"rounded-0",onChange:function(e){O(e.currentTarget.value)}}),w?Object(b.jsx)(N.a,{animation:"border",role:"status",children:Object(b.jsx)("span",{className:"d-none",children:"Loading..."})}):null]})}),Object(b.jsx)(g.a,{md:{span:6,offset:3},className:"d-flex justify-content-center mt-3",children:Object(b.jsx)("p",{className:"error-message",children:i})})]}),Object(b.jsx)(_,{movies:a})]})}function D(){var e=Object(c.useContext)(d).globalState;return Object(b.jsxs)(g.a,{children:[Object(b.jsx)(v.a,{className:"d-flex justify-content-center mt-3",children:0===e.favoriteMovies.length?Object(b.jsx)("span",{children:"Please like some movies"}):null}),Object(b.jsx)(_,{movies:e.favoriteMovies})]})}var P=a(126),z=a(42),F=a(123);a(106);function J(){var e=Object(c.useContext)(d),t=e.globalState,a=e.dispatch,n=Object(c.useState)(!1),s=Object(o.a)(n,2),r=s[0],i=s[1],l=Object(c.useState)(""),j=Object(o.a)(l,2),u=j[0],O=j[1],m=Object(c.useRef)(null),h=""===u;Object(c.useEffect)((function(){m.current&&m.current.focus()}),[]);var x=function(e){setTimeout(e,900)};function p(e){a({type:"SET_PERSISTENCE",payload:e.currentTarget.value})}return Object(b.jsx)(f.a,{fluid:"sm",className:"login-container d-flex justify-content-center mt-4 p-0",children:Object(b.jsx)(g.a,{className:"border border-secondary rounded p-4 col-sm-6",children:Object(b.jsxs)(P.a,{onSubmit:function(e){e.preventDefault(),i(!0),x((function(){a({type:"SET_USER",payload:u}),a({type:"AUTHENTICATE_USER",payload:!0})}))},children:[Object(b.jsxs)(P.a.Group,{className:"mb-3",controlId:"email",children:[Object(b.jsx)(P.a.Label,{children:"Email"}),Object(b.jsx)(P.a.Control,{type:"email",name:"email",ref:m,value:u,size:"sm",onChange:function(e){O(e.currentTarget.value)}})]}),Object(b.jsx)(g.a,{className:"d-flex justify-content-center mt-2",children:Object(b.jsx)(z.a,{type:"submit",size:"sm",variant:"info",disabled:h,children:Object(b.jsx)("span",{children:r?Object(b.jsx)(N.a,{animation:"grow",variant:"light",size:"sm"}):"START"})})}),Object(b.jsx)(v.a,{className:"d-flex justify-content-center mt-2",children:Object(b.jsxs)(g.a,{className:"mb-3 storage-container",children:[Object(b.jsx)(v.a,{className:"d-flex justify-content-center",children:Object(b.jsx)(P.a.Label,{className:"mb-0 text-label",children:"Storage Persistence"})}),Object(b.jsx)(v.a,{className:"d-flex justify-content-center",children:[{name:"Session",value:"sessionStorage"},{name:"Local",value:"localStorage"}].map((function(e,a){return Object(b.jsx)(F.a,{id:"radio-".concat(a),type:"radio",size:"sm",variant:"outline-secondary",name:"radio",className:0===a?"mr-2":"",value:e.value,checked:e.value===t.persistenceType,onChange:p,children:Object(b.jsxs)("span",{children:[" ",e.name]})},a)}))})]})})]})})})}var K=a(125),B=a(127),V=a(124),G=a(73),Y=(a(107),a.p+"static/media/logo.4562cdbe.png");function H(){var e=Object(c.useContext)(d),t=e.globalState,a=e.dispatch,n=Object(m.g)();function s(){return(s=Object(p.a)(x.a.mark((function e(){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a({type:"PURGE_STATE"});case 2:return e.abrupt("return",n.push("/login"));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(b.jsxs)(K.a,{collapseOnSelect:!0,expand:"md",variant:"dark",className:"header",children:[Object(b.jsxs)(K.a.Brand,{children:[Object(b.jsx)("img",{src:Y,alt:"logo",className:"logo"}),Object(b.jsxs)("span",{className:"brand",children:["Movie",Object(b.jsx)("span",{className:"font-weight-bold",children:"Lab"})]})]}),Object(b.jsx)(K.a.Toggle,{"aria-controls":"responsive-navbar-nav"}),Object(b.jsxs)(K.a.Collapse,{id:"responsive-navbar-nav",children:[Object(b.jsxs)(B.a,{className:"mr-auto",children:[Object(b.jsx)(i.c,{to:"/search",activeClassName:"active",className:"mr-3",children:Object(b.jsx)("span",{children:"Search"})}),Object(b.jsx)(i.c,{to:"/favorites",activeClassName:"active",children:Object(b.jsx)("span",{children:"Favorites"})})]}),t.loggedUser?Object(b.jsx)(B.a,{children:Object(b.jsxs)(V.a,{variant:"info",menuAlign:"right",size:"sm",title:t.loggedUser,id:"user-menu",children:[Object(b.jsxs)(G.a.Item,{children:[Object(b.jsx)(w.a,{icon:R.a}),"sessionStorage"===t.persistenceType?"Session Storage":"Local Storage"]}),Object(b.jsx)(G.a.Divider,{}),Object(b.jsxs)(G.a.Item,{eventKey:"1",onClick:function(){return s.apply(this,arguments)},children:[Object(b.jsx)(w.a,{icon:R.d})," Logout"]})]})}):null]})]})}function q(e){var t=e.component,a=e.path,n=e.exact,s=e.pathname,r=Object(c.useContext)(d).globalState;return Object(b.jsx)(m.b,Object(l.a)(Object(l.a)(Object(l.a)({},a),n),{},{children:r.isUserAuthenticated?Object(b.jsx)(t,{}):Object(b.jsx)(m.a,{to:"/login",from:s})}))}function Q(){var e=Object(c.useContext)(d).globalState,t=Object(m.h)().pathname;return Object(b.jsx)(f.a,{fluid:!0,className:"p-0",children:Object(b.jsxs)(i.b,{children:[Object(b.jsx)(H,{}),Object(b.jsxs)(m.d,{children:[Object(b.jsx)(m.b,{exact:!0,path:"/",children:Object(b.jsx)(m.a,{to:"/login"})}),Object(b.jsx)(q,{exact:!0,path:"/search",pathname:t,component:A}),Object(b.jsx)(q,{exact:!0,path:"/favorites",pathname:t,component:D}),Object(b.jsx)(m.b,{exact:!0,path:"/login",children:e.isUserAuthenticated?Object(b.jsx)(m.a,{to:"/favorites",from:t}):Object(b.jsx)(J,{})})]})]})})}var W=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,129)).then((function(t){var a=t.getCLS,c=t.getFID,n=t.getFCP,s=t.getLCP,r=t.getTTFB;a(e),c(e),n(e),s(e),r(e)}))};r.a.render(Object(b.jsx)(n.a.StrictMode,{children:Object(b.jsx)(u,{children:Object(b.jsx)(i.a,{basename:"/movie-lab",children:Object(b.jsx)(Q,{})})})}),document.getElementById("root")),W()},78:function(e,t,a){}},[[114,1,2]]]);
//# sourceMappingURL=main.306251aa.chunk.js.map